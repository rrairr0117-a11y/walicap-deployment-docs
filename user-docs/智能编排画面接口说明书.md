# 智能编排画面接口说明书

**接口地址**: `POST /v1/video/audio-with-images`  
**功能**: 将多个视觉素材（图片或视频）与一段音频和字幕进行自动合成。

---

## 核心参数对照表

### 1. 输入素材 (images)
| 参数名 | 必填 | 类型 | 含义 | 填写示例 |
| :--- | :--- | :--- | :--- | :--- |
| `bucket` | 选填 | string | S3存储桶名称 | `"my-assets"` |
| `folder_prefix` | 选填 | string | S3文件夹路径 | `"project_01/videos/"` |
| `urls` | 选填 | list | 素材URL列表 | `["http://a.mp4", "http://b.mp4"]` |
| `local_folder` | 选填 | string | 本地文件夹路径 | `"/data/assets/01"` |
> **注意**: 以上三种方式（S3/URL/本地）任选其一即可。

### 2. 音频 (audio)
| 参数名 | 必填 | 类型 | 含义 | 填写示例 |
| :--- | :--- | :--- | :--- | :--- |
| `url` | 是 | string | 主音频/配音链接 | `"http://.../voice.mp3"` |

### 3. 字幕 (subtitles) - 智能剪辑必需
| 参数名 | 必填 | 类型 | 含义 | 填写示例 |
| :--- | :--- | :--- | :--- | :--- |
| `subtitles` | 否 | string | SRT字幕文件链接<br>或字幕文本内容 | `"http://.../script.srt"` |

### 4. 背景音乐 (bg_music)
| 参数名 | 必填 | 类型 | 含义 | 填写示例 |
| :--- | :--- | :--- | :--- | :--- |
| `url` | 否 | string | 背景音乐链接 | `"http://.../bgm.mp3"` |

---

## 5. 关键设置 (settings) - 控制剪辑效果

这是控制导演行为的核心区域，请根据需求选择。

| 参数名 | 必填 | 类型 |中文含义 & 选项 | 说明 |
| :--- | :--- | :--- | :--- | :--- |
| **`smart`** | 是 | bool | **是否开启智能剪辑**<br>`true`: 开启 (推荐)<br>`false`: 关闭 (随机轮播) | 开启后，画面会自动对齐字幕时间轴。 |
| **`type`** | 否 | string | **素材类型**<br>`"video"`: 视频素材<br>`"image"`: 图片素材 | 告诉系统您文件夹里放的是视频还是图片。 |
| **`rule`** | 否 | string | **排序/匹配规则**<br>`"order"`: 按文件名顺序 (1,2,3...)<br>`"match"`: 按内容智能匹配 | **order**: 适用于已有分镜顺序的从素材。<br>**match**: 适用于无序素材库，让AI自己挑。 |
| `bg_music_volume` | 否 | float | **背景音乐音量**<br>范围 `0.0` - `1.0` | 默认 `0.4`。数值越小音乐越轻。 |
| `image_duration` | 否 | int | **默认画面时长** (秒) | 仅当 `smart: false` (关闭智能) 时生效。<br>控制每张图/视频的固定播放时长。 |

---

## 完整请求结构 (JSON)

直接复制下方代码即可使用：

```json
{
    "id": "task_001",
    "webhook_url": "https://callback.com/api",

    // 1. 哪里找画面素材？
    "images": {
        "bucket": "my-bucket",
        "folder_prefix": "video_assets/" 
    },

    // 2. 哪里找配音？
    "audio": {
        "url": "http://oss.com/voice.mp3"
    },

    // 3. 哪里找剧本(字幕)？
    "subtitles": "http://oss.com/subtitle.srt",

    // 4. 哪里找背景音乐？(可选)
    "bg_music": {
        "url": "http://oss.com/bgm.mp3"
    },

    // 5. 导演怎么剪？
    "settings": {
        "smart": true,        // 开启智能对齐
        "type": "video",      // 素材是视频
        "rule": "order",      // 按顺序剪辑 (Sequence_01, Sequence_02...)
        "bg_music_volume": 0.2
    },

    // 6. 输出到哪里？
    "output": {
        "filename": "final_video.mp4",
        "cloud_upload": true
    }
}
```
