# 智能导演功能使用指南 (Smart Director)

## 1. 简介：什么是"智能导演"？

在传统的批量视频生成中，图片或视频素材通常是随机播放或按固定时长轮播的，这种方式生成的视频往往缺乏灵魂，画面与解说词对不上号。

**"智能导演"** 是为了解决这个问题而生的。它就像一位经验丰富的剪辑师，能“读懂”您的文案（字幕），并根据文案的情绪、节奏和内容，**自动编排**您的素材库。

它包含两大核心能力：
1.  **视觉导演 (Visual Director)**：帮您把视频/图片素材精准地“贴”在对应的解说词上，并自动调整播放速度以完美卡点。
2.  **听觉导演 (Audio Director)**：帮您自动添加有“呼吸感”的背景音乐，并根据剧情自动插入环境音效（如开门声、脚步声）。

---

## 2. 视觉导演：视频/图片智能卡点

此功能位于 `/v1/video/audio-with-images` 接口中。它不再是简单的“PPT模式”，而是真正的“自动剪辑”。

### 核心玩法

您只需提供三样东西：
1.  **解说音频**
2.  **SRT 字幕文件**（这是导演的剧本，必须提供）
3.  **一堆素材**（视频或图片）

智能导演支持两种**编排规则 (Rule)**：

#### 模式 A：顺序模式 (Order) —— "我有故事板，帮我卡点"
*   **适用场景**：您已经按顺序准备好了 1, 2, 3, 4, 5 号素材，分别对应文案的第1、2、3、4、5段。
*   **导演的工作**：它不会打乱您的素材顺序，但它会根据字幕的语意和停顿，帮您决定**第1个素材该播几秒**，**第2个素材从哪一秒开始切入**。
*   **视频变速**：如果素材太长，它会自动加速；如果素材太短，它会自动慢放或循环，确保画面填满时间槽。

#### 模式 B：智能匹配模式 (Match) —— "我有素材库，帮我挑图"
*   **适用场景**：您有一个包含几十个文件的素材库（如“森林”、“城市”、“天空”），您想让导演自己挑合适的。
*   **导演的工作**：它会阅读您的字幕。当文案提到“神秘的森林”时，它会自动去素材库里找文件名包含 `forest` 或视觉内容相关的素材贴上去。

---

### 如何使用：关键参数 (Settings)

在 API 请求的 `settings` 字段中，只需配置以下三个简单参数：

| 参数名 | 含义 | 必填 | 可选值 | 说明 |
| :--- | :--- | :--- | :--- | :--- |
| **`smart`** | 开启智能导演 | 是 | `true`, `false` | 设为 `true` 即可激活 |
| **`type`** | 素材类型 | 否 | `"video"`, `"image"` | 默认为 `"image"` (图片)。如果是视频素材请填 `"video"` |
| **`rule`** | 编排规则 | 否 | `"order"`, `"match"` | `order`: 按文件名顺序 123 排列 (默认)<br>`match`: 让 AI 帮您挑选匹配 |

### 完整请求体示例

**场景**：制作一个讲述“黑暗森林”的视频，使用 sequential (顺序) 模式。

```json
{
    "id": "my_task_001",
    // 1. 素材库 (可以是本地文件夹，也可以是 S3 路径)
    "images": {
        "local_folder": "C:/Testing/Assets/DarkForest", // 里面放着 01.mp4, 02.mp4...
        // 或者 S3:
        // "bucket": "my-bucket",
        // "folder_prefix": "story_01/"
    },

    // 2. 解说音频
    "audio": {
        "url": "https://example.com/audio/narration.mp3"
    },

    // 3. SRT 字幕 (必须提供!)
    // 导演需要看剧本才知道怎么剪。支持直接传 SRT 文件的下载链接。
    "subtitles": "https://example.com/assets/story_script.srt",

    // 4. 关键配置
    "settings": {
        "smart": true,        // 🟢 开启智能导演
        "type": "video",      // 🟢 告诉它素材是视频
        "rule": "order",      // 🟢 告诉它按文件名顺序剪辑
        
        "bg_music_volume": 0.2 // 背景音乐音量
    },

    // 5. 输出位置
    "output": {
        "filename": "smart_cut_result.mp4",
        "cloud_upload": true
    }
}
```

---

## 3. 听觉导演：智能混音与音效

（注：此功能通常集成在音频生成或独立混音流程中）

### 核心能力

1.  **呼吸感闪避 (Auto Ducking)**：
    *   当解说员说话时，背景音乐自动变小。
    *   当解说员停顿时，背景音乐自动“涌起”。
    *   **无需任何设置**，智能混音模块自动生效。

2.  **语义音效插入 (Semantic SFX)**：
    *   导演会分析字幕。如果字幕提到“突然传来了敲门声”，导演会自动去音效库里找 `knock.mp3` 或 `door.wav`。
    *   它会将音效精准地插入到那句话的**间隙**或**背景**中。

### 总结

现在，通过简单的配置，您生成的不只是一个“视频文件”，而是一部经过剪辑编排、音画同步的作品。无需手动调整时间轴，一切由 **Smart Director** 代劳。
